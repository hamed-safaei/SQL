;WITH CTE AS(
SELECT orderid , productid , qty*unitprice Amount
FROM Sales.OrderDetails )

SELECT * ,
PERCENTILE_CONT(0.25)WITHIN GROUP(ORDER BY Amount)OVER(PARTITION BY productid)Percentile25 ,
PERCENTILE_DISC(0.5)WITHIN GROUP(ORDER BY Amount)OVER(PARTITION BY productid)Percentile50 ,
PERCENTILE_CONT(0.75)WITHIN GROUP(ORDER BY Amount)OVER(PARTITION BY productid)Percentile75 


FROM CTE
